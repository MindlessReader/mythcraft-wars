# kill all troops
$execute as @e[type=!marker,tag=cityTroop,tag=$(cityName)] run tp ~ -100 ~
$kill @e[type=!marker,tag=cityTroop,tag=$(cityName)]

# spawn troops based on troop type tag on marker
$execute at @e[type=marker,tag=$(cityName),tag=spawnmarker_pillager] run summon pillager ~ ~ ~ {Glowing:1b,DeathLootTable:"minecraft:empty",CustomNameVisible:1b,Team:"$(teamName)",PersistenceRequired:1b,Health:30f,Tags:["$(cityName)","cityTroop"],CustomName:'["$(cityName)",{"color":"#FFD700","text":" Marksman"}]',HandItems:[{id:"minecraft:crossbow",count:1,components:{"minecraft:unbreakable":{}}},{}],ArmorItems:[{},{},{},{}],attributes:[{id:"minecraft:generic.knockback_resistance",base:0.2},{id:"minecraft:generic.max_health",base:30},{id:"minecraft:generic.movement_speed",base:0.4},{id:"minecraft:generic.scale",base:1}],HandDropChances:[0F,0F],ArmorDropChances:[0F,0F,0F,0F]}
$execute at @e[type=marker,tag=$(cityName),tag=spawnmarker_vindicator] run summon vindicator ~ ~ ~ {Glowing:1b,DeathLootTable:"minecraft:empty",CustomNameVisible:1b,Team:"$(teamName)",PersistenceRequired:1b,Health:30f,Tags:["$(cityName)","cityTroop"],CustomName:'["$(cityName)",{"color":"#FFD700","text":" Knight"}]',HandItems:[{id:"minecraft:iron_sword",count:1,components:{"minecraft:unbreakable":{}}},{}],ArmorItems:[{},{},{},{}],attributes:[{id:"minecraft:generic.knockback_resistance",base:-1.0},{id:"minecraft:generic.max_health",base:30},{id:"minecraft:generic.movement_speed",base:0.28},{id:"minecraft:generic.scale",base:1}],HandDropChances:[0F,0F],ArmorDropChances:[0F,0F,0F,0F]}
$execute at @e[type=marker,tag=$(cityName),tag=spawnmarker_zombie] run summon zombie ~ ~ ~ {Glowing:1b,CustomNameVisible:1b,DeathLootTable:"minecraft:empty",Team:"$(teamName)",PersistenceRequired:1b,Health:30f,Tags:["$(cityName)","cityTroop"],CustomName:'["$(cityName)",{"color":"#FFD700","text":" Undead"}]',ArmorItems:[{},{},{},{id:"minecraft:iron_helmet",count:1,components:{"minecraft:unbreakable":{}}}],attributes:[{id:"minecraft:generic.attack_damage",base:3},{id:"minecraft:generic.knockback_resistance",base:0},{id:"minecraft:generic.max_health",base:30},{id:"minecraft:generic.movement_speed",base:0.2},{id:"minecraft:generic.scale",base:0.9},{id:"minecraft:generic.burning_time",base:2}],HandDropChances:[0F,0F],ArmorDropChances:[0F,0F,0F,0F]}
$execute at @e[type=marker,tag=$(cityName),tag=spawnmarker_skeleton] run summon skeleton ~ ~ ~ {Glowing:1b,CustomNameVisible:1b,DeathLootTable:"minecraft:empty",Team:"$(teamName)",PersistenceRequired:1b,Health:30f,Tags:["$(cityName)","cityTroop"],CustomName:'["$(cityName)",{"color":"#FFD700","text":" Archer"}]',HandItems:[{id:"minecraft:bow",count:1,components:{"minecraft:unbreakable":{}}},{}],ArmorItems:[{},{},{},{id:"minecraft:iron_helmet",count:1,components:{"minecraft:unbreakable":{}}}],attributes:[{id:"minecraft:generic.attack_damage",base:2},{id:"minecraft:generic.knockback_resistance",base:0.5},{id:"minecraft:generic.max_health",base:30},{id:"minecraft:generic.movement_speed",base:0.3},{id:"minecraft:generic.scale",base:0.9},{id:"minecraft:generic.burning_time",base:2}],HandDropChances:[0F,0F],ArmorDropChances:[0F,0F,0F,0F]}
$execute at @e[type=marker,tag=$(cityName),tag=spawnmarker_witch] run summon witch ~ ~ ~ {Glowing:1b,CustomNameVisible:1b,DeathLootTable:"minecraft:empty",Team:"$(teamName)",PersistenceRequired:1b,Health:25f,Tags:["$(cityName)","cityTroop"],CustomName:'["$(cityName)",{"color":"#FFD700","text":" Sorceress"}]',attributes:[{id:"minecraft:generic.attack_damage",base:2},{id:"minecraft:generic.knockback_resistance",base:-1.0},{id:"minecraft:generic.max_health",base:25},{id:"minecraft:generic.movement_speed",base:0.3},{id:"minecraft:generic.scale",base:0.9},{id:"minecraft:generic.burning_time",base:2}],HandDropChances:[0F,0F],ArmorDropChances:[0F,0F,0F,0F]}
$execute at @e[type=marker,tag=$(cityName),tag=spawnmarker_bosszombie] run summon zombie ~ ~ ~ {Glowing:1b,CustomNameVisible:1b,DeathLootTable:"minecraft:empty",Team:"$(teamName)",PersistenceRequired:1b,Health:50f,Tags:["$(cityName)","cityTroop"],CustomName:'["$(cityName)",{"color":"#FFD700","text":" Undead Commander"}]',HandItems:[{id:"minecraft:diamond_sword",count:1,components:{"minecraft:unbreakable":{}}},{}],ArmorItems:[{},{},{id:"minecraft:chainmail_chestplate",count:1,components:{"minecraft:unbreakable":{}}},{id:"minecraft:netherite_helmet",count:1,components:{"minecraft:unbreakable":{}}}],attributes:[{id:"minecraft:generic.attack_damage",base:6},{id:"minecraft:generic.knockback_resistance",base:0.7},{id:"minecraft:generic.max_health",base:50},{id:"minecraft:generic.movement_speed",base:0.3},{id:"minecraft:generic.scale",base:1.2},{id:"minecraft:generic.burning_time",base:0.5}],HandDropChances:[0F,0F],ArmorDropChances:[0F,0F,0F,0F]}
$execute at @e[type=marker,tag=$(cityName),tag=spawnmarker_bossskeleton] run summon skeleton ~ ~ ~ {Glowing:1b,CustomNameVisible:1b,DeathLootTable:"minecraft:empty",Team:"$(teamName)",PersistenceRequired:1b,Health:40f,Tags:["$(cityName)","cityTroop"],CustomName:'["$(cityName)",{"color":"#FFD700","text":" Greater Archer"}]',HandItems:[{id:"minecraft:bow",count:1,components:{"minecraft:unbreakable":{},"minecraft:enchantments":{levels:{"minecraft:power":2}}}},{}],ArmorItems:[{},{},{id:"minecraft:iron_chestplate",count:1,components:{"minecraft:unbreakable":{}}},{id:"minecraft:netherite_helmet",count:1,components:{"minecraft:unbreakable":{}}}],attributes:[{id:"minecraft:generic.attack_damage",base:5},{id:"minecraft:generic.knockback_resistance",base:0.7},{id:"minecraft:generic.max_health",base:40},{id:"minecraft:generic.movement_speed",base:0.3},{id:"minecraft:generic.scale",base:1.2},{id:"minecraft:generic.burning_time",base:0.5}],HandDropChances:[0F,0F],ArmorDropChances:[0F,0F,0F,0F]}
$execute at @e[type=marker,tag=$(cityName),tag=spawnmarker_bosswitch] run summon witch ~ ~ ~ {Glowing:1b,CustomNameVisible:1b,DeathLootTable:"minecraft:empty",Team:"$(teamName)",PersistenceRequired:1b,Health:50f,Tags:["$(cityName)","cityTroop"],CustomName:'["$(cityName)",{"color":"#FFD700","text":" Head Sorceress"}]',HandItems:[{},{}],ArmorItems:[{},{},{},{}],attributes:[{id:"minecraft:generic.attack_damage",base:4},{id:"minecraft:generic.knockback_resistance",base:0.0},{id:"minecraft:generic.max_health",base:50},{id:"minecraft:generic.movement_speed",base:0.23},{id:"minecraft:generic.scale",base:1.35},{id:"minecraft:generic.burning_time",base:0.5}],HandDropChances:[0F,0F],ArmorDropChances:[0F,0F,0F,0F]}
$execute at @e[type=marker,tag=$(cityName),tag=spawnmarker_blaze] run summon blaze ~ ~ ~ {Glowing:1b,CustomNameVisible:1b,DeathLootTable:"minecraft:empty",Team:"$(teamName)",PersistenceRequired:1b,Health:65f,Tags:["$(cityName)","cityTroop"],CustomName:'["$(cityName)",{"color":"#FFD700","text":" Baron of Blazes"}]',HandItems:[{},{}],ArmorItems:[{},{},{},{}],attributes:[{id:"minecraft:generic.attack_damage",base:6},{id:"minecraft:generic.knockback_resistance",base:1.0},{id:"minecraft:generic.max_health",base:65},{id:"minecraft:generic.movement_speed",base:0.4},{id:"minecraft:generic.scale",base:1.1},{id:"minecraft:generic.burning_time",base:-1}],HandDropChances:[0F,0F],ArmorDropChances:[0F,0F,0F,0F]}
$execute at @e[type=marker,tag=$(cityName),tag=spawnmarker_breeze] run summon breeze ~ ~ ~ {Glowing:1b,CustomNameVisible:1b,DeathLootTable:"minecraft:empty",Team:"$(teamName)",PersistenceRequired:1b,Health:65f,Tags:["$(cityName)","cityTroop"],CustomName:'["$(cityName)",{"color":"#FFD700","text":" Earl of Air"}]',HandItems:[{},{}],ArmorItems:[{},{},{},{}],attributes:[{id:"minecraft:generic.attack_damage",base:6},{id:"minecraft:generic.knockback_resistance",base:0.2},{id:"minecraft:generic.max_health",base:65},{id:"minecraft:generic.movement_speed",base:0.3},{id:"minecraft:generic.scale",base:1.1},{id:"minecraft:generic.burning_time",base:-1}],HandDropChances:[0F,0F],ArmorDropChances:[0F,0F,0F,0F]}
$execute at @e[type=marker,tag=$(cityName),tag=spawnmarker_illusioner] run summon illusioner ~ ~ ~ {Glowing:1b,CustomNameVisible:1b,DeathLootTable:"minecraft:empty",Team:"$(teamName)",PersistenceRequired:1b,Health:65f,Tags:["$(cityName)","cityTroop"],CustomName:'["$(cityName)",{"color":"#FFD700","text":" Duke of Duplication"}]',HandItems:[{id:"minecraft:bow",count:1,components:{"minecraft:unbreakable":{},"minecraft:enchantments":{levels:{"minecraft:punch":2}}}},{}],ArmorItems:[{},{},{},{}],attributes:[{id:"minecraft:generic.attack_damage",base:3},{id:"minecraft:generic.knockback_resistance",base:0.5},{id:"minecraft:generic.max_health",base:65},{id:"minecraft:generic.movement_speed",base:0.33},{id:"minecraft:generic.scale",base:1.1},{id:"minecraft:generic.burning_time",base:-1}],HandDropChances:[0F,0F],ArmorDropChances:[0F,0F,0F,0F]}

$effect give @e[tag=cityTroop,tag=$(cityName)] slowness infinite 9 true